generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = "mysql://root:password@localhost:3306/testingprisma"
}

model User {
  id       String   @id @default(uuid())
  name     String
  email    String   @unique
  password String
  devices  Device[]
}

model Device {
  id         String     @id @default(uuid())
  accessCode String     @unique
  sensors    Sensor[]
  actuators  Actuator[]
  user       User?      @relation(fields: [userId], references: [id])
  userId     String?
}

model Sensor {
  id                   String                @id @default(uuid())
  name                 String
  type                 String
  port                 Int
  data                 SensorData[]
  notificationTriggers NotificationTrigger[]
  device               Device                @relation(fields: [deviceId], references: [id])
  deviceId             String
  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
}

model NotificationTrigger {
  id            String  @id @default(uuid())
  name          String?
  type          String
  logicOperator String
  value         Float
  content       String
  sensor        Sensor  @relation(fields: [sensorId], references: [id])
  sensorId      String
}

model SensorData {
  id       String @id @default(uuid())
  data     Json
  sensor   Sensor @relation(fields: [sensorId], references: [id])
  sensorId String
}

model Actuator {
  id        String            @id @default(uuid())
  name      String
  type      String
  port      Int
  triggers  ActuatorTrigger[]
  device    Device            @relation(fields: [deviceId], references: [id])
  deviceId  String
  createdAt DateTime          @default(now())
}

model ActuatorTrigger {
  id            String   @id @default(uuid())
  name          String
  action        String
  logicOperator String
  value         Float
  description   String
  actuator      Actuator @relation(fields: [actuatorId], references: [id])
  actuatorId    String
}
